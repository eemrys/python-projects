```python
import json
import os
import pandas as pd
from sklearn import preprocessing
import numpy as np
```


```python
data_path = '/volumes/transcend/data/hold_data.csv'
data = pd.read_csv(data_path)
```

### подготовка даты: нужно избавиться от inf, nan, и закодировать данные типа str


```python
from custom import preprocessingData
```


```python
preprocessingData(data)
```

### делает список из строк json чтобы потом записать в текстовый файл


```python
json_string_list = []

for row in data.iterrows():
    json_string = json.dumps(row[1].to_dict()) # 1 потому что на 0 находится индекс, он не нужен
    json_string_list.append(json_string)
```


```python
json_string_list = json_string_list[:100] # чтобы проверить быстрее работает ли
json_string_list += ['stop\n']
input_string = '\n'.join(json_string_list)
```


```python
script_input_path = './data/script_input.txt'
with open(script_input_path, 'w') as file:
    file.write(input_string)
```


```python
python_path = 'python3'
script_path = './my_malware_detector.py'
```


```python
%%time

import subprocess # для макоси рекомендовали использовать вместо os
output = subprocess.check_output(f'cat {script_input_path} | {python_path} {script_path}', shell=True)
```


```python
res = output.decode("utf-8").replace('[', '').replace(']', '')
```


```python
res = res.split('\n')
```


```python
res = res[2:]
```


```python
res.pop()
```


```python
res = [float(i) for i in res]
```


```python
from malware_ml.visualization import plot_roc_curve
import matplotlib.pyplot as plt
columns = data.columns
```

### приминение модели QuadraticDiscriminantAnalysis


```python
plt.figure(figsize=(10,10))
plot_roc_curve(true=data[columns[-1]],
               pred=res,
               name='ROC-кривая на "придерженном" датасете')
```

### приминение модели DecisionTreeClassifier


```python
plt.figure(figsize=(10,10))
plot_roc_curve(true=data[columns[-1]],
               pred=res,
               name='ROC-кривая на "придерженном" датасете')
```

### как видно, несмотря на то, что модель QuadraticDiscriminantAnalysis показала лучшие результаты на "придерженном" датасете лучше всего показала себя модель DecisionTreeClassifier


```python

```
